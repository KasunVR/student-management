<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Notifications</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background: linear-gradient(45deg, #28313b, #485461);
            color: #fff; 
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        .container {
            background-color: #1e272e;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
            width: 400px;
            text-align: center;
        }
        .form-control, .btn {
            margin-top: 15px;
            border-radius: 10px;
        }
        .btn {
            background-color: #ff4081;
            border: none;
        }
        .btn:hover {
            background-color: #97062a;
        }
        .back-button {
            display: block;
            margin-top: 20px;
            color: #fff;
            text-decoration: none;
            background-color: #485461;
            padding: 10px 20px;
            border-radius: 10px;
        }
        .back-button:hover {
            background-color: #3f4d5a;
        }
      
  .custom-btn {
    background-color: rgb(56, 230, 56) ;
    border-color: lightgreen ;
    color: white ;
    border: none;
    padding: 10px 20px;
    border-radius: 10px;
  }

  .custom-btn:hover {
    background-color: #038d2c ;
   
  }
  .notification-item {
            background-color: #2d3436;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 10px;
            text-align: left;
        }
        .action-buttons {
            margin-top: 10px;
            display: flex;
            justify-content: space-between;
        }
        .save-btn, .delete-btn {
            margin: 0 5px;
            flex: 1;
        }
</style>

    </style>
</head>
<body>

<div class="container">
    <h1>Add Notification</h1>
    <form id="notificationForm">
        <input type="text" id="title" class="form-control" placeholder="Enter Title" required>
        <input type="text" id="lecturerName" class="form-control" placeholder="Enter Lecturer Name" required>
        <textarea id="notificationText" class="form-control" rows="4" placeholder="Enter Notification" required></textarea>
        <button type="submit" class="btn btn-primary w-100">Add Notification</button>
        <button type="button" class="btn w-100 custom-btn" id="editNotificationButton">Edit Notification</button>
    <div id="notificationList" style="margin-top: 0.1px;"></div>

    </form>
    
    <a href="lecnotifi.html" class="back-button">Back to Lecturer Panel</a>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
<script>
    document.getElementById('notificationForm').addEventListener('submit', function (e) {
        e.preventDefault();
        const title = document.getElementById('title').value;
        const lecturerName = document.getElementById('lecturerName').value;
        const notificationText = document.getElementById('notificationText').value;
        

        fetch('http://localhost:3005/api/nonesone', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({title, lecturerName, notificationText })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                alert('Notification added successfully!');
                document.getElementById('notificationForm').reset();
            } else {
                alert('Failed to add notification.');
            }
        })
        .catch(error => console.error('Error:', error));
    });

    const apiUrl = 'http://localhost:3005/nonesone';

// Load notifications from the backend
document.getElementById('editNotificationButton').addEventListener('click', function () {
    fetch(apiUrl)
        .then(response => response.json())
        .then(data => {
            displayNotifications(data);
        })
        .catch(error => console.error('Error loading notifications:', error));
});

// Display notifications for editing or deleting
function displayNotifications(notifications) {
    const notificationList = document.getElementById('notificationList');
    notificationList.innerHTML = ''; // Clear previous content

    notifications.forEach((notification, index) => {
        const div = document.createElement('div');
        div.className = 'notification-item';
        div.innerHTML = `
            <input type="text" class="form-control mb-2" value="${notification.title}" id="title-${index}">
            <input type="text" class="form-control mb-2" value="${notification.lecturerName}" id="lecturerName-${index}">
            <textarea class="form-control mb-2" rows="2" id="notificationText-${index}">${notification.notificationText}</textarea>
            <div class="action-buttons">
                <button class="btn btn-success save-btn" onclick="saveNotification(${index})">Save</button>
                <button class="btn btn-danger delete-btn" onclick="deleteNotification(${index})">Delete</button>
            </div>
        `;
        notificationList.appendChild(div);
    });
}

// Save edited notification to backend
function saveNotification(index) {
    const title = document.getElementById(`title-${index}`).value;
    const lecturerName = document.getElementById(`lecturerName-${index}`).value;
    const notificationText = document.getElementById(`notificationText-${index}`).value;

    fetch(`${apiUrl}/${index}`, {
        method: 'PUT',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ title, lecturerName, notificationText })
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            alert('Notification updated successfully!');
        } else {
            alert('Failed to update notification.');
        }
    })
    .catch(error => console.error('Error saving notification:', error));
}

// Delete a notification from the backend
function deleteNotification(index) {
    fetch(`${apiUrl}/${index}`, {
        method: 'DELETE'
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            alert('Notification deleted successfully!');
            document.getElementById('editNotificationButton').click(); // Reload notifications
        } else {
            alert('Failed to delete notification.');
        }
    })
    .catch(error => console.error('Error deleting notification:', error));
}
</script>

</body>
</html>
